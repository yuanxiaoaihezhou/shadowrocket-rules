name: Daily Rule Sync

on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  sync-and-pr:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Download Latest Rules from Upstream
        run: |
          bash sync.sh

      - name: Create Pull Request if rules changed
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "chore: åŒæ­¥ä¸Šæ¸¸è§„åˆ™æ›´æ–°"
          title: "ğŸ”„ æ¯æ—¥è§„åˆ™æ›´æ–°å®¡æŸ¥"
          body: |
            ä¸Šæ¸¸ yfamilys.com çš„è§„åˆ™å‘ç”Ÿäº†å˜åŒ–ã€‚
            è¯·ä»”ç»†å®¡æŸ¥ `Files changed` æ ‡ç­¾é¡µï¼Œç¡®è®¤æ²¡æœ‰æ¶æ„çš„åŸŸåæ³¨å…¥ï¼ˆç‰¹åˆ«æ˜¯é“¶è¡Œã€æ”¯ä»˜ç­‰æ•æ„ŸåŸŸåï¼‰ã€‚
            ç¡®è®¤å®‰å…¨åï¼Œç‚¹å‡» Merge pull request å³å¯ç”Ÿæ•ˆè‡³ä½ çš„å®¢æˆ·ç«¯ã€‚
          branch: "update-rules"
          base: "main"
          delete-branch: true